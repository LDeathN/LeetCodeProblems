#First Problem 1191
class Solution(object):
    def kConcatenationMaxSum(self, arr, k):
        MOD = 10**9 + 7
    
        def kadane(array):
            max_sum = 0
            current_sum = 0
            for num in array:
                current_sum = max(num, current_sum + num)
                max_sum = max(max_sum, current_sum)
            return max_sum
        
        total_sum = sum(arr)
        
        kadane_single = kadane(arr)
        
        if k == 1:
            return kadane_single % MOD
        
        kadane_double = kadane(arr * 2)
        
        if total_sum > 0:
            return (kadane_double + (k - 2) * total_sum) % MOD
        else:
            return kadane_double % MOD



#Second Problem 1193
SELECT 
    DATE_FORMAT(trans_date, '%Y-%m') AS month,
    country,
    COUNT(*) AS trans_count,
    SUM(state = 'approved') AS approved_count,
    SUM(amount) AS trans_total_amount,
    SUM(CASE WHEN state = 'approved' THEN amount ELSE 0 END) AS approved_total_amount
FROM 
    Transactions
GROUP BY 
    DATE_FORMAT(trans_date, '%Y-%m'), country;




